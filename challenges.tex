%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Rulebook RoboCup Logisitc League
%% 2021 Challenges
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[12pt,twoside]{article}

\usepackage[a4paper]{anysize}
\marginsize{2cm}{2cm}{1cm}{2cm}

\setlength{\marginparwidth}{1cm}
%\usepackage{fourier}

\usepackage{floatpag}
\usepackage{wrapfig}
\usepackage{fnpct}

\usepackage[table]{xcolor}

\usepackage[binary-units=true]{siunitx}
%% HYPERREF %%%%%%%%%%%%%%%%%%%
\usepackage{hyperref}
\hypersetup{
  pdftitle      = {The RoboCup Logistics League Challenge Rulebook for 2021},
  pdfauthor     = {RCLL TC},
  pdfkeywords   = {RCLL, Rulebook, Challenges},
  pdfsubject    = {},
  hidelinks,
}
\usepackage{tabularx}
\usepackage{multicol}
\usepackage{multirow}
\usepackage{calc}
\usepackage{float}
\usepackage{hhline}
\usepackage{longtable}

\restylefloat{table}
\newcolumntype{C}{>{\raggedright\arraybackslash}X}

\newcommand{\refsec}[1]{Section~\ref{#1}}
\newcommand{\reffig}[1]{Figure~\ref{#1}}
\newcommand{\refdef}[1]{Definition~\ref{#1}}
%\newcommand{\reflst}[1]{Listing~\ref{#1}}
\newcommand{\reflst}[1]{Figure~\ref{#1}}
\newcommand{\reftab}[1]{Table~\ref{#1}}

\begin{document}
\begin{titlepage}
  \vspace*{5cm}
  \begin{center}
    \begin{LARGE}

      {\bf RoboCup Logistics League}\\[2ex]
			{\Large \bf{Challenges}}\\[4ex]
      {\Large Rules and Regulations 2021}\\[4ex]
    \end{LARGE}
    \hrule

    {\LARGE\vspace*{4ex}}
    \begin{Large}
      The Technical Committee 2012--2021\\[6ex]
    \end{Large}
    \begin{tabular}{lll}
      \textbf{Vincent Coelen}&\textbf{Christian Deppe}&\textbf{Mostafa Gomaa}\\
      \textbf{Till Hofmann}&\textbf{Ulrich Karras}&\textbf{Tim Niemueller}\\
			\textbf{Alain Rohr}&\textbf{Thomas Ulz}&\textbf{Tarik Viehmann}\\[.5em]

      Daniel Ewert&Nils Harder&S\"oren Jentzsch\\
      Nicolas Meier&Sebastian Reuter&Wataru Uemura\\
      Gerald Steinbauer&Tobias Neumann\\
    \end{tabular}
    \vfill
    Revision Date: TBD\\
		DRAFT -- Work in Progress
  \end{center}
\end{titlepage}


\section{Introduction}
\label{sec:intro}
Our aim is to capture the main tasks from the RoboCup Logistics League in
isolated challenges, which form an additional competition in the league.
Main objectives of this new competition are:
\begin{itemize}
	\item to provide a framework that allows teams to show and evaluate their
		progress in the individual tasks of the RCLL
	\item to ease the preparation for the main competition through providing a
		simplified cost- and space-efficient setup suitable for replication in
		local labs
	\item to be attractive for both RoboCup live events and online competitions,
		where teams can participate remotely from all over the world
\end{itemize}

\section{Competition Area}
\subsection{Field Layout}
The competition area may vary for each challenge, but it always consists of
a rectangular area divided in square zones of \SI{1 x 1}{\metre}.
Possible layouts are
\begin{itemize}
\item \SI{5 x 5}{\metre}: \emph{default} size
	(sufficient for all different types of challenges)
\item \SI{3 x 3}{\metre}: \emph{small} size
	(some type of challenges are not possible on this field)
\item \SI{7 x 8}{\metre}: \emph{halve-RCLL} size
	(allows close replication of main competition)
\item \SI{14 x 8}{\metre}: \emph{full-RCLL} size
	(full RCLL field)
\end{itemize}

The entire area belongs to a single team.
\subsection{Remote Layout}
Todo - some sort of camera arrangement needed to stream, rules for humans on field etc
\subsection{Machines}
Todo - specs for mockup machines
\section{Game Play}
\subsection{Competition Scope}
Todo: X time slots of Y minutes per team, each timeslot can be used to solve
at most one challenge, a team can decide to fail a challenge and use another slot to improve.
A team can use a single slot to try a challenge multiple times (with the same field layout)
once a challenge counts, it cannot be attempted again (unless difficulty is improved).

\subsection{Available Challenges}
Challenges have different types and variations (difficulty levels).
The overall score of the competition is calculated by summing up the score
in the most difficult challenge achieved in each of the challenge types.
The challenge types of the competition are described in
\refsec{sec:challenge-navigation}-\ref{sec:challenge-markerless}

The RefBox is used to log the scores and data for each challenge.
Todo: implement challenges in refbox, provide tool to evaluate results

\subsubsection{Navigation Challenge}\label{sec:challenge-navigation}
Basic navigation task without unknown obstacles. Difficulties vary depending
on the number of available robots, the field layout and the navigation
objective (see \reftab{tab:challenge-navigation}).

TODO: what criterion for reaching a corner/machine?
\begin{table}[!htb]
    \centering
        \begin{tabularx}{\linewidth}{l|l|C|l}
					Field Size & Machines & Description & Scoring \\\hline
					\SI{3 x 3}{\metre} & 0/1 & \multirow{4}{\hsize}{Drive 1/2/3 circles
					covering all corners/machines. Field contains insertion zone of
					\SI{1 x 3}{\metre} without walls.
					Return to insertion zone when done.
					Stop time. (Repeat $x$ times?)} & - \\
				\SI{5 x 5}{\metre} & $\leq 4$  &  & - \\
				\SI{7 x 8}{\metre} & $\leq 7$  &  & - \\
				\SI{14 x 8}{\metre} & $\leq 14$ &  & -
        \end{tabularx}
    \caption{Navigation Challenge}
    \label{tab:challenge-navigation}
\end{table}

\subsubsection{Exploration Challenge}\label{sec:challenge-exploration}
Replicate the RCLL exploration phase by finding a set number of machines on the
field. Machine Marker detection as well as navigational skills are required
to solve this challenge. Variable in the number of machines
(see \reftab{tab:challenge-exploration}).
\begin{table}[!htb]
    \centering
        \begin{tabularx}{\linewidth}{l|l|C|l}
					Field Size & Machines & Description & Scoring \\\hline
					\SI{5 x 5}{\metre} & $\leq 4$  & \multirow{3}{\hsize}
					{Exploration as in the main game. Field contains insertion zone of
						\SI{1 x 3}{\metre} without walls. Return to insertion zone when
						done. Stop time. (Repeat $x$ times?)} & - \\
					\SI{7 x 8}{\metre} & $\leq 7$    & & - \\
					\SI{14 x 8}{\metre} & $\leq 14$   & & -
        \end{tabularx}
    \caption{Exploration Challenge}
    \label{tab:challenge-exploration}
\end{table}


\subsubsection{Grasping Challenge}\label{sec:challenge-grasping}
Simple grasping task. Variants gradually require  better grasping speed
(as this is a timed challenge) and robustness (multiple robots grasp multiple
times). See \reftab{tab:challenge-grasping}.
\begin{table}[!htb]
    \centering
        \begin{tabularx}{\linewidth}{l|l|C|l}
					Field Size & Machines & Description & Scoring \\\hline
					\SI{3 x 3}{\metre} & 1 & \multirow{4}{\hsize}{Fixed field. Each Machine has a base at output. Bring base to same machine's input. Robots start at cell in front of a machine output. Return to start when done. Stop time. (Repeat $x$ times?)} & - \\
				\SI{5 x 5}{\metre} & $\leq 3$  &  & - \\
				\SI{7 x 8}{\metre} & $\leq 3$  &  & - \\
				\SI{14 x 8}{\metre} & $\leq 3$ &  & -
        \end{tabularx}
    \caption{Grasping Challenge}
    \label{tab:challenge-grasping}
\end{table}

\subsubsection{C0 Challenge}\label{sec:challenge-c0}
This challenge encapsulates the production of the most simple product in the
RCLL. Variants for a variable number of available machines are supplied as
shown in \reftab{tab:challenge-c0}.
\begin{table}[!htb]
    \centering
        \begin{tabularx}{\linewidth}{l|l|C|l}
					Field Size & Machines & Description & Scoring \\\hline
					\SI{3 x 3}{\metre} & 2 & Fixed field. BS and CS.
					Robots start at cell between machines.
					Return to start while holding finished product. Stop time. & - \\\hline
					\SI{5 x 5}{\metre} & 3-4 & \multirow{3}{\hsize}{ BS, CS and DS.
					Robots start at insertion zone without walls. Stop time.} & - \\
				\SI{7 x 8}{\metre} & $3-7$  &  & - \\
				\SI{14 x 8}{\metre} & $3-14$ &  & -
        \end{tabularx}
    \caption{C0 Challenge}
    \label{tab:challenge-c0}
\end{table}

\subsubsection{CX Challenge - 1 RS}\label{sec:challenge-cx-1rs}
Extending the C0 challenge (\refsec{sec:challenge-c0}) by requiring a ring
station (mockup), a product of any size can be built.
This might result in product variants that are not ground to the current
RCLL rules (such as having multiple rings of the same color).
Difficulty depends on the number of total rings as well as the total
amount of payment needed to mount rings (See \reftab{tab:challenge-cx-1rs}).
\begin{table}[!htb]
    \centering
        \begin{tabularx}{\linewidth}{l|l|C|l}
					Field Size & Machines & Description & Scoring \\\hline
					\SI{5 x 5}{\metre} & 4 & \multirow{3}{\hsize}{ BS, CS, RS and DS.
					Ring needs 0/1/2 Payment.
					Robots start at insertion zone without walls. Stop time.} & - \\
				\SI{7 x 8}{\metre} & $4-7$  &  & - \\
				\SI{14 x 8}{\metre} & $4-14$ &  & -
        \end{tabularx}
    \caption{CX Challenge - 1 RS}
    \label{tab:challenge-cx-1rs}
\end{table}

\subsubsection{CX Challenge - 2 RS}\label{sec:challenge-cx-2rs}
Extension of the previous challenge (\refsec{sec:challenge-cx-1rs}) by adding
the second ring station. Hence the production of any RCLL product can be
replicated. For details see \reftab{tab:challenge-cx-2rs}.
\begin{table}[!htb]
    \centering
        \begin{tabularx}{\linewidth}{l|l|C|l}
					Field Size & Machines & Description & Scoring \\\hline
					\SI{5 x 5}{\metre} & 4 & \multirow{3}{\hsize}{ BS, CS, RS1 and RS2
					(and DS). total ring payment 0-6.
					Robots start at insertion zone without walls.
					Return with product to insertion zone (deliver product). Stop time.} & - \\
				\SI{7 x 8}{\metre} & $4-7$  &  & - \\
				\SI{14 x 8}{\metre} & $4-14$ &  & -
        \end{tabularx}
    \caption{CX Challenge - 2 RS}
    \label{tab:challenge-cx-2rs}
\end{table}

\subsubsection{Full game}\label{sec:challenge-full-game}
Play a full RCLL game on a possibly reduced field and without an opposing team.
See requirements for CX challenges in \reftab{tab:challenge-cx-2rs}.

\subsubsection{Web shop}\label{sec:challenge-CX-1rs}
Produce orders provided by the web shop through an opposing team.
This challenge could be part of the existing CX challenges
\reftab{tab:challenge-c0}-\ref{tab:challenge-cx-2rs}.

\subsubsection{Markerless Detection}\label{sec:challenge-markerless}
Image classification challenge, no physical robots needed. TBD.

\end{document}
